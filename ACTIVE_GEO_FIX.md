# Исправление отправки геолокации в активном режиме

## Проблема
В активном режиме геолокация не отправлялась напрямую через API, а только кэшировалась в `backgroundService` и отправлялась каждые 30 секунд.

## Причина
В `backgroundService.js` был зарегистрирован дублирующий обработчик `onLocation`, который перехватывал все события геолокации и только кэшировал их, не отправляя напрямую через API.

## Решение

### 1. Обновлен `src/location.js`
- Добавлено подробное логирование в обработчик `onLocation`
- Теперь логируется каждый полученный сигнал геолокации
- Логируется процесс отправки через `postLocation` API
- Логируется отправка в `BackgroundService` для кэширования

### 2. Обновлен `src/services/backgroundService.js`
- Убран дублирующий обработчик `onLocation` из метода `initializeBackgroundGeolocation`
- Теперь `backgroundService` получает геолокацию только через `location.js`
- Это позволяет `location.js` отправлять геолокацию напрямую через API

## Как это работает теперь

1. **BackgroundGeolocation** генерирует события геолокации каждые 10 секунд (в тестовом режиме)
2. **location.js** получает эти события через свой обработчик `onLocation`
3. **location.js** отправляет геолокацию напрямую через `postLocation` API (если пользователь аутентифицирован)
4. **location.js** также отправляет геолокацию в `backgroundService` для кэширования
5. **backgroundService** кэширует геолокацию и отправляет накопленные данные каждые 30 секунд

## Результат
- В активном режиме геолокация теперь отправляется каждые 10 секунд напрямую через API
- Дополнительно геолокация кэшируется и отправляется пакетами каждые 30 секунд
- Подробное логирование позволяет отслеживать процесс отправки

## Логи для отладки
Теперь в консоли будут видны следующие сообщения:
```
[17:08:02] Location received in location.js: {lat: 55.7558, lon: 37.6176, ...}
[17:08:02] Sending location via postLocation API...
[17:08:02] Location sent successfully via postLocation API
[17:08:02] Sending location to BackgroundService for caching...
```

## Тестирование
Для проверки работы:
1. Запустите приложение в режиме разработки
2. Войдите в систему
3. Откройте консоль Metro/React Native
4. Должны появиться логи отправки геолокации каждые 10 секунд
5. В webhook должны приходить как прямые отправки, так и пакетные отправки
