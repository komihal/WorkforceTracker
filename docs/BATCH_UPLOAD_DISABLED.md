# Отключение пакетной отправки геолокации

## Изменения

Пакетная отправка геолокации через `backgroundService` была отключена. Теперь геолокация отправляется только напрямую через API каждые 10 секунд.

## Что было отключено

### 1. В `src/location.js`
- Убрана отправка геолокации в `backgroundService` для кэширования
- Теперь геолокация отправляется только напрямую через `postLocation` API

### 2. В `src/services/backgroundService.js`
- Отключен интервал сбора геоданных (`intervalId`)
- Отключен интервал пакетной отправки (`uploadIntervalId`)
- Обновлена статистика для отражения отключенного состояния

## Как работает сейчас

1. **BackgroundGeolocation** генерирует события геолокации каждые 10 секунд (в тестовом режиме)
2. **location.js** получает эти события через обработчик `onLocation`
3. **location.js** отправляет геолокацию напрямую через `postLocation` API (если пользователь аутентифицирован)
4. **backgroundService** больше НЕ кэширует и НЕ отправляет геолокацию пакетами

## Логи

Теперь в консоли будут видны следующие сообщения:
```
[17:08:02] Location received in location.js: {lat: 55.7558, lon: 37.6176, ...}
[17:08:02] Sending location via postLocation API...
[17:08:02] Location sent successfully via postLocation API
[17:08:02] Batch upload disabled - location sent only via direct API
```

## Статистика backgroundService

```javascript
const stats = backgroundService.getStats();
console.log(stats);
// {
//   pendingPhotos: 0,
//   pendingGeoData: 0,
//   isRunning: true,
//   isTestMode: true,
//   batchUploadEnabled: false,    // Пакетная отправка отключена
//   directUploadOnly: true,       // Только прямая отправка
//   geoInterval: 10,              // Активный интервал (сек)
//   backgroundGeoInterval: 10,    // Фоновый интервал (сек)
//   uploadInterval: 'disabled',   // Отключен
//   distanceFilter: 5,            // Дистанционный фильтр (м)
//   heartbeatInterval: 10         // Heartbeat интервал (сек)
// }
```

## Результат

- **Только прямая отправка**: геолокация отправляется каждые 10 секунд напрямую через API
- **Нет пакетной отправки**: больше нет отправки накопленных данных каждые 30 секунд
- **Упрощенная архитектура**: один путь отправки геолокации через `location.js`
- **Меньше нагрузки на сервер**: нет дублирующих отправок

## Включение пакетной отправки обратно

Если потребуется включить пакетную отправку обратно:

1. В `src/location.js` раскомментировать отправку в `backgroundService`
2. В `src/services/backgroundService.js` включить интервалы сбора и отправки
3. Обновить статистику для отражения включенного состояния

## Тестирование

Для проверки работы:
1. Запустите приложение в режиме разработки
2. Войдите в систему
3. Откройте консоль Metro/React Native
4. Должны появиться логи отправки геолокации каждые 10 секунд
5. В webhook должны приходить ТОЛЬКО прямые отправки (без пакетных)
