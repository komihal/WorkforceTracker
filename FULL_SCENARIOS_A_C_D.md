# –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ A/C/D —Å –∞–∫—Ç–∏–≤–Ω—ã–º —Ç—Ä–µ–∫–∏–Ω–≥–æ–º

## üéØ **–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!**

**BG_TEST_FORCE_TRACKING=1** –≤–∫–ª—é—á–µ–Ω - —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º BG Geo —Ç—Ä–µ–∫–∏–Ω–≥–æ–º.

---

## üì± **–®–∞–≥–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

### **1. –í–∫–ª—é—á–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—Ä–µ–∫–∏–Ω–≥**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ WorkforceTracker
2. –ù–∞–∂–º–∏—Ç–µ –∑–µ–ª–µ–Ω—É—é –∫–Ω–æ–ø–∫—É **"üî¨ BG Test Suite"**
3. –í —Å–µ–∫—Ü–∏–∏ **"Test Tracking Override"** –Ω–∞–∂–º–∏—Ç–µ **"Start Test Tracking"**
4. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ: **"Test tracking started! BG Geo will now track even without active shift."**
5. –°—Ç–∞—Ç—É—Å –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞ **"üü¢ Active"**

### **2. Scenario A: Revoke Background ‚Üí Move**

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ "While Using" —Ñ–æ–Ω–æ–≤—ã–µ HTTP —Å–æ–±—ã—Ç–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è.

**–®–∞–≥–∏**:
1. **–í–∫–ª—é—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—Ä–µ–∫–∏–Ω–≥** (—Å–º. –≤—ã—à–µ)
2. **–°–¥–µ–ª–∞–π—Ç–µ —Å–Ω–∏–º–æ–∫ –ª–æ–≥–æ–≤**:
   ```bash
   adb logcat -c && adb logcat -d -v time -s TSLocationManager ReactNativeJS > bggeo_A_revoke.log
   ```
3. **–ò–∑–º–µ–Ω–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ**:
   - –û—Ç–∫—Ä–æ–π—Ç–µ Settings ‚Üí Apps ‚Üí WorkforceTracker ‚Üí Permissions ‚Üí Location
   - –ò–∑–º–µ–Ω–∏—Ç–µ —Å **"Allow all the time"** –Ω–∞ **"Allow only while in use"**
4. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏ –ø–æ—Ö–æ–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã
5. **–ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ —ç–∫—Ä–∞–Ω** –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ —Ö–æ–¥–∏—Ç—å 2-3 –º–∏–Ω—É—Ç—ã
6. **–†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
- ‚úÖ **PASS**: –ù–µ—Ç HTTP —Å–æ–±—ã—Ç–∏–π –≤–æ –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —ç–∫—Ä–∞–Ω–∞
- ‚ùå **FAIL**: HTTP —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ

### **3. Scenario C: Doze ‚Üí Move**

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –≤ doze —Ä–µ–∂–∏–º–µ –∏ batch upload –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è.

**–®–∞–≥–∏**:
1. **–í–∫–ª—é—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—Ä–µ–∫–∏–Ω–≥**
2. **–°–¥–µ–ª–∞–π—Ç–µ —Å–Ω–∏–º–æ–∫ –ª–æ–≥–æ–≤**:
   ```bash
   adb logcat -c && adb logcat -d -v time -s TSLocationManager ReactNativeJS > bggeo_C_doze.log
   ```
3. **–í–∫–ª—é—á–∏—Ç–µ doze —Ä–µ–∂–∏–º**:
   ```bash
   adb shell dumpsys deviceidle enable
   adb shell dumpsys deviceidle force-idle
   ```
4. **–ü–æ—Ö–æ–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã** (—Ç–æ—á–∫–∏ –¥–æ–ª–∂–Ω—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è)
5. **–û—Ç–∫–ª—é—á–∏—Ç–µ doze**:
   ```bash
   adb shell dumpsys deviceidle disable
   ```
6. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 30 —Å–µ–∫—É–Ω–¥** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ batch upload

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ **PASS**: –ü–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è doze –ø—Ä–∏—Ö–æ–¥–∏—Ç batch upload (onSync, –Ω–µ—Å–∫–æ–ª—å–∫–æ onHttp 2xx)
- ‚ùå **FAIL**: –ù–µ—Ç batch upload –ø–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è doze

### **4. Scenario D: Airplane ‚Üí Online**

**–¶–µ–ª—å**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ –∏ batch upload –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ç–∏.

**–®–∞–≥–∏**:
1. **–í–∫–ª—é—á–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—Ä–µ–∫–∏–Ω–≥**
2. **–°–¥–µ–ª–∞–π—Ç–µ —Å–Ω–∏–º–æ–∫ –ª–æ–≥–æ–≤**:
   ```bash
   adb logcat -c && adb logcat -d -v time -s TSLocationManager ReactNativeJS > bggeo_D_airplane.log
   ```
3. **–í–∫–ª—é—á–∏—Ç–µ airplane —Ä–µ–∂–∏–º**:
   ```bash
   adb shell settings put global airplane_mode_on 1
   ```
4. **–ü–æ—Ö–æ–¥–∏—Ç–µ 5-10 –º–∏–Ω—É—Ç** (—Ç–æ—á–∫–∏ –¥–æ–ª–∂–Ω—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è –æ—Ñ—Ñ–ª–∞–π–Ω)
5. **–û—Ç–∫–ª—é—á–∏—Ç–µ airplane —Ä–µ–∂–∏–º**:
   ```bash
   adb shell settings put global airplane_mode_on 0
   ```
6. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 60 —Å–µ–∫—É–Ω–¥** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ batch upload

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ **PASS**: –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ç–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç batch upload (onSync, –Ω–µ—Å–∫–æ–ª—å–∫–æ onHttp 2xx)
- ‚ùå **FAIL**: –ù–µ—Ç batch upload –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ç–∏

---

## üîç **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤**

### **–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö**:

1. **HTTP —Å–æ–±—ã—Ç–∏—è**:
   ```
   [BG][http] true 200 ...
   ```

2. **Batch upload**:
   ```
   [BG][sync] batch uploaded: 15 locations
   ```

3. **Location —Å–æ–±—ã—Ç–∏—è**:
   ```
   [BG][location] 55.7558 37.6176 acc=5.0
   ```

4. **–û—à–∏–±–∫–∏**:
   ```
   [BG][Error] ...
   ```

### **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞**:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTTP —Å–æ–±—ã—Ç–∏—è
grep "\[BG\]\[http\]" bggeo_A_revoke.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å batch upload
grep "\[BG\]\[sync\]" bggeo_C_doze.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å location —Å–æ–±—ã—Ç–∏—è
grep "\[BG\]\[location\]" bggeo_D_airplane.log

# –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π
grep -c "\[BG\]\[http\]" bggeo_*.log
```

---

## üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ê–∫—Ç–∏–≤–Ω—ã–π —Ç—Ä–µ–∫–∏–Ω–≥ | –§–æ–Ω–æ–≤—ã–π —Ç—Ä–µ–∫–∏–Ω–≥ | Batch upload |
|----------|------------------|-----------------|--------------|
| **A: Revoke Background** | ‚úÖ HTTP —Å–æ–±—ã—Ç–∏—è | ‚ùå –ù–µ—Ç HTTP | N/A |
| **C: Doze Mode** | ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ | ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ | ‚úÖ Batch –ø–æ—Å–ª–µ disable |
| **D: Airplane Mode** | ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ | ‚úÖ –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ | ‚úÖ Batch –ø–æ—Å–ª–µ online |

---

## üöÄ **–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!**

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã:
- ‚úÖ **–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–ª–∞–≥ –≤–∫–ª—é—á–µ–Ω** (BG_TEST_FORCE_TRACKING=1)
- ‚úÖ **UI –æ–±–Ω–æ–≤–ª–µ–Ω** —Å –∫–Ω–æ–ø–∫–æ–π —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã** –¥–ª—è —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è

**–ù–∞—á–∏–Ω–∞–π—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ!** üéØ
